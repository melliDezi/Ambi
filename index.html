<!DOCTYPE html> 
<html lang="en"> 
<head>

  <meta charset='UTF-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"> 

<link href="https://fonts.googleapis.com/css2?family=Varela+Round&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
     
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<style>html, body{

  font-family: 'Varela Round', sans-serif;
  display: flex; 
  flex-direction: column;
  } 
  
  
  .content{
   
    flex: 1 0 auto;
  }
  
  
  *{ 
  
      box-sizing: border-box;
      margin: 0;
      padding: 0;
  
  
  } 
  
  
  .container{
  
      width: 90;
      margin: 0 auto;
      padding: 10px;
      overflow: none;
  } 
  
  
  .app-header{
      background-color: #efefef;
      box-shadow: 3px 3px 10px #887; 
      border-radius: 5px;
  } 
  .app-header .logo{
      width: 170px;
      margin-bottom: 16px;
  } 
  
   #appName{
  
      color: #ffff;
      font-size: 24px;
   }
  
  
  .app-header .container{
      display: flex;
      flex-direction: column;
      align-items:center;
      justify-content: center;
      padding: 15px 10px;
  
  } 
  
  .app-header input[type="text"]{
  
      padding: 7px; 
      width: 300px; 
      height: 39px;
      border: 0;
      border-radius: 30px; 
      font-family: 'Varela Round', sans-serif; 
      /*background: #f3eded; */
      color: #000;
      display: block;
      
  } 
  
  
  ::placeholder { /* Chrome, Firefox, Opera, Safari 10.1+ */
      font-family: 'Varela Round', sans-serif;
      opacity: 1; /* Firefox */
    }
    
    :-ms-input-placeholder { /* Internet Explorer 10-11 */
      font-family: 'Varela Round', sans-serif;
    }
    
    ::-ms-input-placeholder { /* Microsoft Edge */
      font-family: 'Varela Round', sans-serif;
    }   
  
  
    .inputAndMagnifyingBtn{
  
    position: relative;
    width: 300px;
    } 
  
  
  
    .inputAndMagnifyingBtn button {
      background: transparent;
      color: #013238;
      border: none;
      cursor: pointer;
      display: inline-block;
      font-size: 20px;
      position: absolute;
      top: 0;
      right: 0;
      padding: 8px 20px;
      z-index: 2;
    }
  
  
  
    .subheader {
      background: #ffff;
      color: #345D60;
      /*box-shadow: 3px 3px 10px #888888;*/
      font-size: 14px;
      padding: 39px;
      width: 100%;
      margin: 0 auto 1rem;
      display: flex;
      align-items: center;
      justify-content: space-between; 
    }
    
  
    .city{
      font-family: 'Montserrat', sans-serif;
      font-size: 24px;  
      margin: 4px;
      
    } 
  
  
    .temp{
      font-family: 'Montserrat', sans-serif;
      font-size:22px;
      font-weight: bold; 
      margin: 4px;
    }  
  
    .feelsLike{
  
      font-family: 'Montserrat', sans-serif;
      font-size:16px;
      margin-bottom: 8px;
    }
  
  
  
  
    .hi-low {
  
    font-family: 'Montserrat', sans-serif;
  
    } 
  
  
    .gridOf3{
  
      background: #104245;  
      
    
  
      color:#fff;   
  
      box-shadow: 3px 3px 10px #888888;
  
  
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
     /* grid-template-columns: 1fr 1fr 1fr; if we wanted three items horizontally in our grid! */
      grid-gap: 10px; 
  
      margin: 0 auto 1rem;
  
      width: 90%;
      border-radius: 8px;
  
    } 
  
    .gridOf3 .item3{
  
      display: flex;
     flex-direction: column;
     /*border: 1px #febe1b solid; */
     border-radius: 20px;
     padding: 15px; 
     
  
     font-family: 'Montserrat', sans-serif; 
  
     
    }
  
  
    .grid{
      background: #fea035;  
      /*background-color: #fbb034;*/
      background-image: linear-gradient(315deg, #ffdd00 0%, #fea035 74%);
    
  
      color:#ffff;   
  
      box-shadow: 3px 3px 10px #888888;
  
  
      display: grid;
      grid-template-columns: 1fr 1fr;
     /* grid-template-columns: 1fr 1fr 1fr; if we wanted three items horizontally in our grid! */
      grid-gap: 10px; 
  
      margin-top: 70px;
      
    } 
  
    .grid .item{
     display: flex;
     flex-direction: column;
     border: 1px #febe1b solid; 
     border-radius: 10px;
     padding: 15px; 
     box-shadow: 1px 1px 2px #d38f41;
  
     font-family: 'Montserrat', sans-serif; 
    
    }  
  
  
    .grid .item h4{
    margin-bottom:5px;
    align-self: center;
    } 
  
  
    .grid .item p{
  
  
      font-size: 14px; 
      margin-bottom: 20px;
      align-self: center;
  
    }
  
    .grid .item img{
     width: 30px; 
     align-self: center;
      
  }   


#fivedayforecast{

display: flex;
flex-direction: column; 

} 


#cloudForecastBtn{ 
width: 30px;
align-self: center;
} 

#fiveDayTriHourlyForecastTitle{
align-self: center;
} 

  </style>

<!----<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" 
rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" 
crossorigin="anonymous">---->

<!---<link rel='stylesheet' href='weatherLatest.css'>-----> 
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script> 
<!---<script src='moment.js'></script>
<script src='momenttimezone.js'></script>---->

    <title>Weather App Sceendy</title>
  </head>


<body>  

<!-------------------------<div id="splash"> 
  <img src="img/logo.png" class="logo">
</div>------------------> 


<div class="content"> 
  <header class="app-header"> 
    <div class="container"> 
      <img src="logoPlant500px.png" class="logo"/> 
      <p id='appName'>Weatheree.</p> 
      <div class="inputAndMagnifyingBtn">
      <input type="text" class="search-box" placeholder="Search a city..." results="0"><button type="submit"><i class="fa fa-search"></i></button> 
    </div>
    </div>
  </header>

  <div class="subheader">
    <div>
      <p class='city'>Bangkok, TH</p>
      <p class='temp' id="tempNumber">35 <span id='celcius'>°c</span></p>
      <p class='feelsLike'>feels like 28</p>
      <p class='weather'>Sunny</p>  
      <p class='hi-low'>12°c /17°c</p>  
    </div>
    <img src="sky.png" class='icon' alt="" />
  </div> 


  <div class='gridOf3 containerOf3'>
    <div class="item3"> 
      <h4 class='Precip'>Precipitation: 7%</h4>
    </div> 

    <div class="item3"> 
      <h4 class='Wind'>Wind: 5km/h</h4>
    </div>

    <div class="item3"> 
      <h4 class='Gusts'>Gusts: 9%</h4>
    </div>
  </div>


  <div class="grid container">
    <div class="item"> 
      <h4 class='hi-lowtemps'></h4>
      <p>High/Low</p>
      <img src="white-thermometer.png"/>
    </div>

    <div class="item"> 
      <h4 class='humidity humi'>Humidity:</h4>
      <p>Daily humidity</p>
      <img src="water (1).png"/>
    </div> 


    <div class="item"> 
      <h4 class='cloudCover'>Cloudiness:</h4>
      <p>Cloud cover</p>
      <img src="cloud (2).png"/>
    </div> 


    <div class="item"> 
      <h4 class='airQuality'>AQI</h4>
      <p>2RXs ready to refill</p>
      <img src="medical.png"/>
    </div> 

    
    <div class="item" id="UVBtn"> 
      <h4 class='uvIndexNum'>UV index</h4>
      <p id="UVBlurb">More info</p> 
      <img src="uv-protection.png"/>
    </div> 


    
    <div class="item"> 
      <h4>Hair Care</h4>
      <p>2RXs ready to refill</p>
      <img src="uv-protection.png"/>
    </div> 

  </div>

<!-------------------<div id='fivedayforecast'> 
      <img src='cloud (2).png' id='cloudForecastBtn'>
    </div>-- NOT needed as we will try to show graphs on separate page!-------->
</div> 


<!----<div id='fiveDayForecastResults'>   

  <img id='cloudForecastBtn'src="sky.png">
 <p id="fiveDayTriHourlyForecastTitle">Click the cloud to view your 5 day / 6-hourly weather forecast.</p>
  <div id='listDiv2'></div>
  </div>---->



<footer class="app-footer"></footer> 



<!--------------------Charts & Graphs Below 


<div id='chartCanvasDiv'>
  <canvas id="myChart" width="400" height="200"></canvas> 
  </div> 
  
  
    <div id='chartCanvasDiv2'>
      <canvas id="myHumidityChart" width="400" height="200"></canvas> 
      </div> 
  
  
  
      <div id='chartCanvasDiv3'>
        <canvas id="myChart3" width="400" height="200"></canvas> 
        </div>---------------------->





        <!------<script src='weatherLatest.js'></script>-----> 

        <script type='text/javascript'>
        
        
        console.log('yello');   


console.log('ze sweetest peaches');    




if(window.chart && window.chart !== null){ 


    console.log('time to destroy chart'); 
    window.chart.destroy();
    }
    
    
         window.myChart ;  
    
    
    
          let arrayOfTempsNDates =[];   
          let datesArray =[]; 
          let tempsArray =[];  
          let humidityArray =[];
    
          var ul = document.createElement('ul'); 
          let uli =document.createElement('ul');
          var listDiv = document.getElementById('listDiv'); 
          let listDiv2 = document.getElementById('listDiv2'); 
          
          


const api= {
      
      key:"5e4558760b4e3c113797ae8bea9ee0be", 
      
      base:"https://api.openweathermap.org/data/2.5/"
      
      }   


      const IQApi = {

      key:"a7977a94-bb99-4d8a-8691-b9feb4fbeced"

     } 

      
      const searchBox = document.querySelector('.search-box');
      
      searchBox.addEventListener('keypress', setQuery); 
      
      
      
      
      function setQuery(evt){
      
      if(evt.keyCode ==13 /*&& searchBox.value.length !==0*/){ 

        getResults(searchBox.value); 
      
        get5DayForecast(searchBox.value);
        console.log(searchBox.value); 
        arrayOfTempsNDates = []; 
        ul.style.display='none'; 
     


        }
      }  




    function getResults(query) { 
      console.log('huuuuuuh?');
      fetch(`${api.base}weather?q=${query}&units=metric&APPID=${api.key}`) //send the apirequest when u type in a cty & hit enter
     .then(function(resp) {return resp.json(); console.log('yo what');}) //THEN if it works,  get the response back in json format
     .then(displayResults);//THEN if that works, run the displayResults function(which hs access to the query we're passing into this getResults()func) 
  
        }     

      


function displayResults(resp) { 

        

     let city = document.querySelector('.city');  

      console.log('did u get the city?')

      city.innerText= `${resp.name}, ${resp.sys.country}`; 




      let timestamp = `${resp.dt}`; 

      console.log(`WHOOHOO ${timestamp}`)

        




          let temperature = document.querySelector('.temp'); 
          temperature.innerHTML =`${Math.round(resp.main.temp)}<span>º</span>`; 

          let feelsLike = document.querySelector('.feelsLike');
          feelsLike.innerHTML = `Feels like ${Math.round(resp.main.feels_like)}<span>ºc</span>`; 


          let weatherIcon =document.querySelector('.icon'); 


          let weatherConditions = document.querySelector('.weather'); 
          weatherConditions.innerHTML = resp.weather[0].main; 
 
         let weatherDescripString =JSON.stringify(weatherConditions.innerHTML);  

         console.log(weatherDescripString); 

         if(weatherDescripString == 'Clouds'){ 

            weatherIcon.src="sky.png";
          }
 
 
 
           let highLowGrid = document.querySelector('.hi-low'); 
           let highLowTemps = document.querySelector('.hi-lowtemps')

          


           
           highLowGrid.innerText =`${Math.round(resp.main.temp_max)}ºc /${Math.round(resp.main.temp_min)}ºc`;
 
           highLowTemps.innerText =`${Math.round(resp.main.temp_max)}ºc /${Math.round(resp.main.temp_min)}ºc`;
 
 
           const humidity= document.querySelector('.humidity'); 
           humidity.innerHTML =` Humidity: ${resp.main.humidity}% `;  
 
 
           let cloudCover = document.querySelector('.cloudCover'); 
           cloudCover.innerHTML = `Cloudiness: ${resp.clouds.all}%`;
 
           let lat = resp.coord.lat;  
           let lon = resp.coord.lon;   
 
           let cityName = resp.name;
           console.log(`latitude is ${lat} & longitude is ${lon} for ${resp.name}`);   
 
       let uvNum = document.querySelector('.uvIndexNum'); 
           let uvExplanation =  document.querySelector('.uvIndexExplanation'); 
           let uvicon = document.querySelector('.UVicon');     
 
 
 
 
           
 
           //Making Fetch call toget uv index info from openweather map
 
           fetch(`http://api.openweathermap.org/data/2.5/uvi?appid=${api.key}&lat=${lat}&lon=${lon}`)
          .then(function(respz){return respz.json();}) 
          .then(function(respz){ 
            console.log(`${respz.value} is the uv index value for ${cityName} and the longi is ${respz.lon}`) 
            
             
            uvNum.innerText =`Daily UV Index Number: ${respz.value}`;    
 
            //This below part is to display the uv message when we click our uv button:
 
           let UVBtn =document.getElementById('UVBtn'); 
           let UVBlurb =document.getElementById('UVBlurb') 
           let tooltiptext= document.querySelector('.tooltiptext')
 
           /*UVBtn.addEventListener('click', function(event){ 
             UVBlurb.innerHTML =`Current UV Index Number is ${respz.value}`;  
           }); */
 
           UVBtn.addEventListener('mouseover', function(event){  
             
           
             if(respz.value <=2) { 
                UVBlurb.innerHTML = `Low danger from the Sun's UV rays for the average person. Wear sunglasses on bright days. If you burn easily, cover up & use broad spectrum SPF 30+ sunscreen. Bright surfaces, such as sand, water, and snow, will increase UV exposure.`;
              }else if(respz.value >=3 && respz.value<=5){  
                UVBlurb.innerHTML =  `Moderate risk of harm from unprotected Sun exposure.
                Stay in shade near midday when the Sun is strongest. If outdoors, wear Sun protective clothing, a wide-brimmed hat, & UV-blocking sunglasses. Generously apply broad spectrum SPF 30+ sunscreen every 2 hours, even on cloudy days, & after swimming or sweating.`;
              } else if(respz.value>5 && respz.value <= 7 ){ 
                UVBlurb.innerHTML= 'High risk of harm from unprotected Sun exposure.Protection against skin & eye damage is needed.'; 
              
              } else if(respz.value>7 && respz.value <= 10 ){ 
                UVBlurb.innerHTML = 'Very high risk of harm from unprotected Sun exposure. Take extra precautions as unprotected skin and eyes will be damaged & can burn quickly.';
               
              }else if(respz.value>= 11 ){ 
                UVBlurb.innerHTML = 'Extreme risk of harm from unprotected Sun exposure. Take all precautions as unprotected skin & eyes can burn in minutes. Try to avoid Sun exposure between 10 a.m. & 4 p.m.';
               
              }
          })  
 
 
          UVBtn.addEventListener('mouseleave', function(event){  
             
             UVBlurb.innerHTML ='';
          }) 
 
 
              
 
 
 
              })  
 
 
 
 
 
              //The below is to fetch the  air quaity from iqair airvisual & display it:
 
              let airQualityIcon = document.querySelector('.airQualityIcon');
          
 
 
             const requestOptions = {
             method: 'GET',
             redirect: 'follow'
           }; 
 
 
 
 
            //fetch("https://api.airvisual.com/v2/nearest_city?lat="+lat+"&lon="+lon+"&key=a7977a94-bb99-4d8a-8691-b9feb4fbeced", requestOptions)
 
 
 
           fetch(`https://api.airvisual.com/v2/nearest_city?lat=${resp.coord.lat}&lon=${resp.coord.lon}&key=${IQApi.key}`, requestOptions)  
           .then(response => response.text())
           .then((result) => {console.log(JSON.parse(result)); let resultz = (JSON.parse(result)); let airQuality = document.querySelector('.airQuality'); 
           console.log(resultz); 
          airQuality.innerText =` The current air quality index rating is ${resultz.data.current.pollution.aqius}`; 
          //airQualityIcon.src='medical.png'; 
 
          
          let airQualBtn = document.getElementById('clickMe1');  
           let airQualBlurb = document.getElementById('airQualityBlurb');
 
 
 
 //This below part is to display the airQuality number when we mouseover our AQI button:
 
           airQualBtn.addEventListener('mouseover', function(event){  
             
              airQualBlurb.innerHTML =` Current air quality index: ${resultz.data.current.pollution.aqius}`; 
           }) 
 
 
           airQualBtn.addEventListener('mouseleave', function(event){ 
             airQualBlurb.innerHTML = '';
           })
 
    
   
     let airQualityExplanation = document.querySelector('.airQualityExplanation');
   if(resultz.data.current.pollution.aqius <= 50) { 
     airQualityExplanation.innerText = 'Air quality is considered satisfactory, and air pollution poses little or no risk.';
     
   }else if (resultz.data.current.pollution.aqius >50 && resultz.data.current.pollution.aqius <=100){airQualityExplanation.innerText = "Moderate: Air quality is acceptable and poses little health risk.Sensitive individuals should avoid outdoor activity as they may experience respiratory symptoms.";
     } else if(resultz.data.current.pollution.aqius >100 && resultz.data.current.pollution.aqius <=150){airQualityExplanation.innerText ="Unhealthy for Sensitive Groups: General public and sensitive individuals in particular are at risk to experience irritation and respiratory problems.";
 
 } else if(resultz.data.current.pollution.aqius >150 && resultz.data.current.pollution.aqius <=300){airQualityExplanation.innerText ="Unhealthy: Increased likelihood of adverse effects and aggravation to the heart and lungs among general public. Avoid outdoor exercise and take care to wear a pollution mask outdoors. Ventilation is discouraged. Air purifiers should be turned on.";}
    
 else if(resultz.data.current.pollution.aqius >300){airQualityExplanation.innerText ="Hazardous!: General public and sensitive groups are at high risk to experience strong irritations and adverse health effects that could trigger other illnesses. Everyone should avoid exercise and remain indoors.";}
 
    })
   .catch(error => console.log('error', error)); 
  
 
 
           //added below myself to show cloudy pic if temp is equal to or below 10c---Yesus Yimesgen! it worked
           
           if(resp.main.temp <=10){
           
           weatherIcon.src="sky.png";
       
           document.body.style.backgroundColor = "#e8edfc";
          
          } else if(resp.main.temp >=30) { 
 
           //document.body.style.backgroundColor ="#f3e3e2";  
  
           document.body.style.background= "-webkit-linear-gradient(to right, #ee0979, #ff6a00)"; /* Chrome 10-25, Safari 5.1-6 */
           document.body.style.background = "linear-gradient(to right, #ee0979, #ff6a00)"; /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
 }
  
            
 
 }//end of displayResults() function here  
 

 function get5DayForecast(query){  
         
      
    fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${query}&units=metric&appid=${api.key}`)
    . then(response => response.text())
    .then((text) => {console.log(JSON.parse(text));let resultz = JSON.parse(text); console.log(resultz.list[0].main.temp); 
       
      
      let list = resultz.list;  
      let fiveDayForecastResults = document.getElementById('fiveDayForecastResults');   






      //let arrayOfTempsNDates =[];    

      const fiveDayForecastBtn = document.getElementById('cloudForecastBtn');

      //var ul = document.createElement('ul'); 
      //var listDiv = document.getElementById('listDiv'); 

      //May not be necessary!------listDiv.appendChild(ul);

     


      fiveDayForecastBtn.addEventListener('click', function(event){  

        



       //let uli= document.createElement('ul');



      for (var i=0; i<list.length; i+=2) {  


        
        

        let dateAndForecast = 
        `Date: ${list[i].dt_txt} 

      Temp: ${list[i].main.temp}`; 

        let humidityAndDate = `Date: ${list[i].dt_txt} Humidity:  ${list[i].main.humidity}` 

        humidityArray.push(list[i].main.humidity); 
        console.log(humidityArray);   


        let humidityArrayDatesNTempsCheck = []; 

        humidityArrayDatesNTempsCheck.push(humidityAndDate); 

        //console.log(humidityArrayDatesNTempsCheck);            

        datesArray.push(list[i].dt_txt);   

        //console.log(datesArray);
        tempsArray.push(list[i].main.temp); 
        //console.log(tempsArray);


        var ctx = document.getElementById('myChart').getContext('2d');  

       


        var gradient = ctx.createLinearGradient(500, 0, 100, 0);
        gradient.addColorStop(0, "#80b6f4");
        gradient.addColorStop(0.3, "#f49080");
        gradient.addColorStop(0.4, "#80b6f4");
        gradient.addColorStop(0.5, "#f49080");
        gradient.addColorStop(0.7, "#80b6f4");
        gradient.addColorStop(1, "#f49080");



        //here we're saying if any previous line chart exists, first destroy that existing chart, so we can create a new (non-flickering) one below: 

          
          if(window.chart){

          window.chart.destroy();
       
          };    /* in this case, w/ the 1st line chart. using destroy() works to stop 
          flickering but for 2nd barchart had to create & use a function called resetCanvas() instead*/

             




       

          

        

          

          





           //create line chart:

        window.chart = new Chart(ctx, {
type: 'line',
data: { 
labels: datesArray, 
datasets: [{ 
  data: tempsArray,
  label: "temps", 
  borderColor: gradient,
      pointBorderColor: gradient,
      pointBackgroundColor: gradient,
      pointHoverBackgroundColor: gradient,
      pointHoverBorderColor: gradient,
      pointBorderWidth: 7,
      pointHoverRadius: 7,
      pointHoverBorderWidth: 1,
      pointRadius: 1,
      fill: false,
      borderWidth: 2,
     
}]
},
options: {
legend: {
      position: "bottom"
  },
  scales: {
      yAxes: [{
          ticks: {
              fontColor: "rgba(0,0,0,0.5)",
              fontStyle: "bold",
              beginAtZero: true,
              maxTicksLimit: 5,
              padding: 20
          },
          gridLines: {
              drawTicks: false,
              display: false
          }
}],
      xAxes: [{
          gridLines: {
              zeroLineColor: "transparent"
},
          ticks: {
              padding: 20,
              fontColor: "rgba(255, 255, 255, 0.5)",
              fontStyle: "bold"
          }
      }]
  },
title: {
display: true,
text: '5 day/ 6-hourly forecast'
}
} 

});

      


//chart.update(); 

/*
if(window.chart && window.chart !== null){ 


console.log('time to destroy chart'); 
window.chart.destroy();
}*/ 





// bar chart below: 




var ctx2 =document.getElementById('myHumidityChart').getContext('2d');


//here we're saying if any previous line chart exists, first destroy that existing chart, so we can create a new (non-flickering) one below: 



/*
if(window.myChart && window.myChart !== null){ 


console.log('time to destroy chart'); 
window.myChart.destroy();
} */


var resetCanvas = function(){
$('#myHumidityChart').remove(); // this is my <canvas> element
$('#chartCanvasDiv2').append('<canvas id="myHumidityChart"><canvas>');
canvas = document.querySelector('#myHumidityChart');
ctx2 = canvas.getContext('2d');
ctx2.font = '10pt Verdana';
ctx2.textAlign = 'center';



/*var gradient = ctx2.createLinearGradient(0, 0, 1, 2000);
gradient.addColorStop(0, 'rgb(252, 0, 255, 1)');   
gradient.addColorStop(0.8, 'rgba(0,219,222,1)');  
gradient.addColorStop(1, 'rgb(255,255, 255, 1)'); */



var img2 = new Image();
img2.src = 'blueswirl.jpg'; 
//img2.src = 'https://images.unsplash.com/photo-1545873509-33e944ca7655?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60'; 

img2.onload = function() {
var fillPattern2= ctx2.createPattern(img2, 'repeat');



window.myChart = new Chart(ctx2, {
type: 'bar',
data: {
  labels: //['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange']  
  datesArray,
  datasets: [{
      label: 'Humidity over the next 5 days',
      data: humidityArray,
      backgroundColor: [ /*gradient,  
      gradient, 
      gradient,  
      gradient,  
      gradient, 
      gradient, 
      gradient,  
      gradient,  
      gradient, 
      gradient, 
      gradient,  
      gradient,  
      gradient,
      gradient, 
      gradient,  
      gradient,  
      gradient, 
      gradient, 
      gradient,  
      gradient,  
      gradient,
      gradient, 
      gradient,  
      gradient,  
      gradient,
      gradient, 
      gradient,  
      gradient,  
      gradient,
      gradient, 
      gradient,  
      gradient,  
      gradient,
      gradient, 
      gradient,  
      gradient,  
      gradient,
      gradient, 
      gradient,  
      gradient,  
      gradient */ 

      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2,
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2,
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2,
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2,
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2,
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2, 
      fillPattern2
      ],
      borderColor: [
      'rgba(255, 255, 255, 0)'
      ],
      borderWidth: 0
  }]
},
options: {
  scales: { 
    xAxes: [{
      gridLines: {
          color: "rgba(0, 0, 0, 0)",
      }
  }],
      yAxes: [{ 
        gridLines: {
          color: "rgba(0, 0, 0, 0)",
      },
          ticks: {
              beginAtZero: true
          }
      }]
  }
}
}); 


}

}





var img = new Image();
img.src = 'https://images.unsplash.com/photo-1545873509-33e944ca7655?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60';
img.onload = function() {
var ctx3 = document.getElementById('myChart3').getContext('2d');
var fillPattern= ctx3.createPattern(img, 'repeat');
var chart3 = new Chart(ctx3, {
type: 'bar',
data: {
labels: ['Item 1', 'Item 2', 'Item 3', 'Item 4', 'Item 5', 'n', 'm', 'u', 'o', 'p','i', 't'],
datasets: [{
data: [5.5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22, 25, 27],
backgroundColor: fillPattern
}]
}
})
} 





//console.log(`Here are all the temps for next 5 days: ${list[i].main.temp}, Date & Time: ${list[i].dt_txt}`);  
arrayOfTempsNDates.push(dateAndForecast);  
//console.log(arrayOfTempsNDates);


//console.log(arrayOfTempsNDates);    


resetCanvas();//This is tocall the func() that will delete and then reappend the 2nd canvas holding our bar chart-this recreatesthe chart each time & works instead of using destroy() for THIS chart



//ATTENTION: THE BELOW Commented out CODE forlooping through the arrayOfTempsNDates is for Creating a list of Divs Containing  our 5 day/ 6 hourly forecast-since we have the charts (& plus,dates are all utc)  & i couldn'tstyle them,Idecided to try notshowing them:


/* for (var j=0; j<arrayOfTempsNDates.length; j++) {  

let div5DayItem = document.createElement('div'); 

//let uli =document.createElement('ul');  

// listDiv2 = document.getElementById('listDiv2'); 

//listDiv2.appendChild(ul);  

listDiv2.appendChild(div5DayItem);   



let pLi= document.createElement('p')

pLi.classList.add('listParagraph');

div5DayItem.appendChild(pLi);

//ul.appendChild(div5DayItem);

div5DayItem.classList.add("div5DayItem");


pLi.innerHTML += arrayOfTempsNDates[j];  

//uli.appendChild(li);

//document.getElementById('showArray').innerHTML= arrayOfTempsNDates[j];

} */



arrayOfTempsNDates.splice(0,arrayOfTempsNDates.length);


/*
arrayOfTempsNDates.forEach(function (item) {
let li = document.createElement('li');
ul.appendChild(li);

li.innerHTML += item; 

document.getElementById('showArray').innerHTML= item;
}); */ 





/*arrayOfTempsNDates.splice(0,arrayOfTempsNDates.length);
let toggle5DayList = false; */


/*
//fiveDayForecastResults.innerHTML =`Here are all the temps for next 5 days: ${list[i].main.temp}, Date & Time: ${list[i].dt_txt}`

var ul = document.getElementById("FiveDayForecastList");    

//var listDiv = document.createElement('div'); 
//listDiv.className = 'listDivGroup'; 


//ul.appendChild(listDiv); 


//So now create a li and attach it to the div, which willbe attached to our ul: 

var li = document.createElement('li'); 
li.innerText=` Temp: ${list[i].main.temp} 

${list[i].dt_txt} 

`;  

ul.appendChild(li);


let toggle5DayList = false;

//ul.style.display="none";//so it can be blank til we click for 5dayforecasts!  
*/  

let toggle5DayList = false;


if(toggle5DayList==false){ 


ul.style.display = "block";  
clearInputNdisplay();
}


if(searchBox.value == ''){ 


//console.log('empty!') 

//let uli =document.createElement('ul');


for (var j=0; j<arrayOfTempsNDates.length; j++) {  

let li = document.createElement('li'); 

//let uli =document.createElement('ul');  
uli.setAttribute("class", "rightList");

document.getElementById('listDiv2').appendChild(uli);




li.innerHTML += arrayOfTempsNDates[j];  

uli.appendChild(li);

document.getElementById('showArray').innerHTML= arrayOfTempsNDates[j];

} 



searchBox.addEventListener("focus", function(){ 

   
 console.log('ok now on focus clear the li')  
 location.reload();  

 //chart.update(); 
 //$("#listDiv2").remove(); 
 //$("ul").empty(); 
 //$('.rightList').remove(); 
 
/* var listNodes = uli.getElementsByTagName("li");
for(var i=0; i<listNodes.length; i++) {
listNodes[i].innerHTML='';
}*/
 
 //$("ul").remove();
 //uli.style.display='none'; 
 //uli.innerHTML='';
//list.length=0;  
//arrayOfTempsNDates.length=0; 
arrayOfTempsNDates.splice(0,arrayOfTempsNDates.length);
console.log(arrayOfTempsNDates);

}); 

} 

} 



//arrayOfTempsNDates.splice(0,arrayOfTempsNDates.length);




   
   
      }  
          
     
 








 

 
      )} 
      
    )} 

    



function dateBuilder (d) {

let months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]; 

let days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"]; 

let day = days[d.getDay()]; 


let month = months[d.getMonth()]; 


let date = d.getDate();

let year = d.getFullYear();

return `${day}, ${month} ${date}, ${year} `

}




function clearInputNdisplay(){ 

searchBox.value="";    




} 




 
 
 
 
 
 
 
 
 
 
         
 





         

        
        
        </script> 

</body>
</html>
