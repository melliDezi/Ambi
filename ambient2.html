<!DOCTYPE html> 
<html lang="en"> 
<head>

  <meta charset='UTF-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"> 

<link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
     

<style>html, body{

  font-family: 'Montserrat', sans-serif;
  display: flex; 
  flex-direction: column;

   flex: 1 0 auto;
    background-color: #485461;
    background-image: linear-gradient(315deg, #485461 0%, #28313b 74%);
    color:white; 
    background-repeat: no-repeat; 
    background-size: 132%;
  } 

  
  .content{
   
    flex: 1 0 auto;
flex: 1 0 auto;
    background-color: #485461;
    background-image: linear-gradient(315deg, #485461 0%, #28313b 74%);
    color:white;
  }
  
  
  *{ 
  
      box-sizing: border-box;
      margin: 0;
      padding: 0;
  
  
  } 
  
  
  .container{
  
      width: 90;
      margin: 0 auto;
      padding: 10px;
      overflow: none;
  } 
  
  
  .app-header{
      background-color: #efefef;
      box-shadow: 3px 3px 10px #887; 
      border-radius: 5px;
  } 
  .app-header .logo{
      width: 170px;
      margin-bottom: 16px;
  } 
  
   #appName{
  
     background-image: url('gold-foil-texture.jpg');
    background-repeat: repeat;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    
    font-size: 32px;
    text-align: center;
    font-weight: lighter;
    text-transform: uppercase;
    /* background-repeat: repeat; */
    background-size: 100%;
    margin-bottom: 9px;
   }



  #welcome{ 

background-image: url(gold-foil-texture.jpg);
    background-repeat: repeat;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-size: 16px;
    text-align: center;
    font-weight: lighter;
    text-transform: uppercase;
    /* background-repeat: repeat; */
    background-size: 100%;
    margin-bottom: 9px;
    margin-top: 70px;
}
</style> 

<title>Weather App Sceendy</title>
  </head>


<body>  

<!-------------------------<div id="splash"> 
  <img src="img/logo.png" class="logo">
</div>------------------> 


<div class="content"> 
  <header class="app-header"> 
    <div class="container">  
      <p id='appName'>Ambient.</p>  
    </div> 

    
  </header> 

   <p id="welcome">Welcome to a Smarter Way of Life.</p>
</div> 

<h3 id='cityName'>Press Enter to See Charts: </h3> 

<div id='tryingForm'> 
  <form action="ambient2.html" method="GET">
    <input id="getSearchedCity" type="text" name="searchedCityName" />
    <input id='submitBtn' type="submit" value="Submit" placeholder='Enter'/> 
</form> 

<h3 id='cityNCountryName'>City and Country:</h3>



<a href='index.html'>Return to Main Page</a>
<!-------------Charts & Graphs Below ----------------------->


<div id='chartCanvasDiv'>
  <canvas id="myChart" width="400" height="200"></canvas> 
  </div> 
  
  
    <div id='chartCanvasDiv2'>
      <canvas id="myHumidityChart" width="400" height="200"></canvas> 
      </div> 
  
  
  
      <div id='chartCanvasDiv3'>
        <canvas id="myChart3" width="400" height="200"></canvas> 
        </div>









<script>

/*let cityNameValue= localStorage["key"];  

let cityName=document.getElementById('cityName'); 

cityName.innerHTML =cityNameValue;*/ 

let search=document.getElementById('getSearchedCity');


let cityNamee= search.value;


const api= {
      
      key:"5e4558760b4e3c113797ae8bea9ee0be", 
      
      base:"https://api.openweathermap.org/data/2.5/"
      
      }   




      const IQApi = {

     key:"a7977a94-bb99-4d8a-8691-b9feb4fbeced"

       }     




       let cityNCountryName=document.getElementById('cityNCountryName'); 


        const submitBtn =document.getElementById('submitBtn'); 









        if(window.chart && window.chart !== null){ 


console.log('time to destroy chart'); 
window.chart.destroy();
}


     window.myChart ;  



      let arrayOfTempsNDates =[];   
      let datesArray =[]; 
      let tempsArray =[];  
      let humidityArray =[];

      var ul = document.createElement('ul'); 
      let uli =document.createElement('ul');
      var listDiv = document.getElementById('listDiv'); 
      let listDiv2 = document.getElementById('listDiv2'); 
      
                 

















window.addEventListener('DOMContentLoaded', function getQueryVariable(cityNamee) { 


  


    


    var query = window.location.search.substring(1); 

    console.log(query); 

    var vars = query.split('&');

    console.log(vars);
    for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split('=');

        console.log(pair);  

        console.log(pair[1]);  

        for(var j=0; j<pair.length; j++){

          var splitCityTwoWords= pair[1].split('+');
          console.log(splitCityTwoWords);
        } 

        for(let k=0;k<splitCityTwoWords.length; k++){  

          var str = '';

          let getSearchedCity=document.getElementById("getSearchedCity"); 

          if(splitCityTwoWords.length === 1){

            getSearchedCity.value = splitCityTwoWords + '';

          } 
          else if(splitCityTwoWords.length === 2){

        

        //cityName.innerHTML =pair[1];  

        getSearchedCity.value=  str + splitCityTwoWords[0] +' '+splitCityTwoWords[1]; 

          } else if (splitCityTwoWords[2] ==undefined){

            getSearchedCity.value =  str + splitCityTwoWords[0] + ' ' + splitCityTwoWords[1] ;

          } else if(splitCityTwoWords[2] !==undefined){



            getSearchedCity.value =  str + splitCityTwoWords[0] + ' ' + splitCityTwoWords[1] +  ' ' + splitCityTwoWords[2] ;
          } else{


            getSearchedCity.value ='Please enter a valid city name.'
          } 

          console.log(getSearchedCity.value +' right here!') 


          let citySearched =getSearchedCity.value;
        
            

          console.log('Query variable %s not found', citySearched);   




          console.log('hello yall');
            

            cityNCountryName.innerHTML = citySearched;

            function getResults(citySearched) { 
           console.log('whuuuuuuh?');
           fetch(`https://api.openweathermap.org/data/2.5/weather?q=${citySearched}&units=metric&APPID=5e4558760b4e3c113797ae8bea9ee0be`) //send the apirequest when u type in a cty & hit enter
          .then(function(resp) {return resp.json();}) //THEN if it works,  get the response back in json format
           .then(displayResults);//THEN if that works, run the displayResults function(which hs access to the query we're passing into this getResults()func) 
            }   





            function displayResults(resp) { 
          cityNCountryName.innerHTML=`${resp.name}, ${resp.sys.country}`;

            console.log('did u get the city?')


                let timestamp = `${resp.dt}`; 

                console.log(`WHOOHOO ${timestamp}`)  



                let lat = resp.coord.lat;  
           let lon = resp.coord.lon;   
 
           let cityName = resp.name;
           console.log(`latitude is ${lat} & longitude is ${lon} for ${resp.name}`);   
        





    fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${lat}&lon=${lon}&appid=${api.key}`)
           //fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=13.75&lon=100.52&appid=${api.key}`)
          .then(function(respz){return respz.json();}) 
          .then(function(respz){ 
            console.log(respz)
            console.log(respz.timezone);
          }); 


        };//end of func displayResults here




          getResults(citySearched);







        }
   

  

    } 





      

            
            
            
           
            


        





           });







</script>
</body> 
</html>